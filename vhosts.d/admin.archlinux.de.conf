server {
	server_name admin.archlinux.de;

	root /srv/http/vhosts/admin.archlinux.de/htdocs;
	access_log /var/log/nginx/admin.archlinux.de-access.log;
	error_log /var/log/nginx/admin.archlinux.de-error.log;

	include hosts.d/archlinux.de.conf;

	auth_basic "Administration";
	auth_basic_user_file /srv/http/vhosts/admin.archlinux.de/passwords;

	autoindex on;

	client_max_body_size 5m;
	client_body_timeout 60;

	location = /favicon.ico {
		alias /srv/http/favicon.ico;
		expires 2M;
	}

	location ^~ /phpMyAdmin/ {
		root /usr/share/webapps;
		location ~ \.php$ {
			try_files $uri =404;
			fastcgi_pass unix:/run/php-fpm/admin.socket;
		}
		location ~ \.(jpg|gif|png|css|js|ico)$ {
			expires 2M;
		}
	}

	location ~ ^/xcache/([a-z]+)/(.*\.php)$ {
		fastcgi_pass unix:/run/php-fpm/$1.socket;
		include fastcgi.conf;
		fastcgi_param SCRIPT_FILENAME /usr/share/php-xcache/admin/$2;
	}

	location ~ ^/xcache/([a-z]+)/(.*)$ {
		alias /usr/share/php-xcache/admin/$2;
		expires 2M;
	}
}
